
import * as moment from 'moment';



/**
 * Used for getting messages in user setup profile
 */

export default {
    

    getAllInfo()
    {
          return new Promise((resolve) => {
              axios
                .get("getMyProfile")
                .then(response => {

                  //map response to match tables
                  const jobs_completed = response.data.jobs;
                  
                  let arr_mapped  = jobs_completed.map((elem) => {
                    return {
                      'client_name' : elem.name,
                      'review' : elem.pivot.review,
                      'rating' : elem.pivot.rating,
                      'price' : elem.pivot.price
                    }
                  })
                  

                  const projects_completed = response.data.projects;

                  let projects_mapped = projects_completed.map((elem)=> {
                    return {
                      'title' : elem.title,
                      'desc' : elem.description,
                      'date_from' : moment(elem.date_from).format("DD-MM-YYYY"),
                      'date_to' : moment( elem.date_to ).format("DD-MM-YYYY")
                    }

                  })  

                  const obj_res = {
                    'jobs' : arr_mapped,
                    'proj' : projects_mapped,
                    'cv' : response.data.pentester.cv
                  }

                  resolve(
                    obj_res
                  );
                
                })
                .catch(function(error) {
                  console.error(error);
                  // vm.errorToast("Error happened.", "Error!");
                });
          });    

    }
}