<template>
  <div id="job_poster" class="comp_container">
    <h2 class="h2s">Post your CV here.</h2>


    <div class="group_input_title">

      <h3 class="h3s">
        Insert biography.
      </h3>
      
      <textarea  
      :placeholder="bio.label"
      :class="{'has-error':errBio}"
      :type="bio.type"
      :id="bio.id" 
      v-model="bio.value" 
      required:true
        v-validate="{
        rules:{
            required:true
        }}"
      :name="bio.id">
      
      </textarea>


      <span v-if="errors.has(bio.id)" class="incorrect_input">
          {{bio.id_upper}} required!
      </span>
    
    </div>


    <div class="group_input_title">

      <h3 class="h3s">
        Insert skills.
      </h3>
      
      <textarea  
      :placeholder="skills.label"
      :class="{'has-error':errSkills}"
      :type="skills.type"
      :id="skills.id" 
      v-model="skills.value" 
      required:true
        v-validate="{
        rules:{
            required:true
        }}"
      :name="skills.id">
      
      </textarea>


      <span v-if="errors.has(skills.id)" class="incorrect_input">
          {{skills.id_upper}} required!
      </span>
    
    </div>

    
    <div class="group_input_title">

      <h3 class="h3s">
        Insert education.
      </h3>
      
      <textarea  
      :placeholder="education.label"
      :class="{'has-error':errEducation}"
      :type="education.type"
      :id="education.id" 
      v-model="education.value" 
      required:true
        v-validate="{
        rules:{
            required:true
        }}"
      :name="education.id">
      
      </textarea>


      <span v-if="errors.has(education.id)" class="incorrect_input">
          {{education.id_upper}} required!
      </span>
    
    </div>


    <div class="group_input_title">
      <h3 class="h3s">
        Insert image.
      </h3>

      <b-form-file 
      name="avatar"
      accept=".jpg, .png, .gif" 
      :state="!errAvatar"
      v-model="avatar_image" 
      @change="processFile($event)"
      required:true
    v-validate="{
    rules:{
        required:true
    }}"
      placeholder="Choose file">

      </b-form-file>

      
      <span v-if="errors.has('avatar')" 
      class="incorrect_input">
          Image required!
      </span>

    </div>

    

    <b-button class="btn btn-info btn-secondary actionbtn" @click="submitHandler()">
      Post  <icon name="file-alt" id="hands_icon"></icon>
    </b-button>
  </div>


</template>

<script>
import eventBus from "../../../utils/eventBus";

import Icon from "vue-awesome/components/Icon";
import "vue-awesome/icons/file-alt";
import JobFormInput from "../../utilcomps/JobPosterInput.vue";
import CvPostAPI from "../../../services/api/pentester_api/CvPost.api";

export default {
  created() {},
  computed: {
    errBio() {
      return this.errors.has(this.bio.id);
    },
    errSkills() {
      return this.errors.has(this.skills.id);
    },
    errEducation() {
      return this.errors.has(this.education.id);
    },
    errAvatar() {
      return this.errors.has("avatar");
    }
  },
  components: {
    JobFormInput,
    Icon
  },
  mixins: [],
  mounted() {},
  methods: {
    processFile(event) {
      this.form_data.append("avatar", event.target.files[0]);
    },
    validateAvatar() {
      if (!this.errAvatar) return "invalid";
      else return "valid";
    },
    submitHandler() {
      CvPostAPI.handleCvPosting(this, this.$validator);
    }
  },
  data() {
    return {
      avatar_image: null,
      form_data: new FormData(),

      bio: {
        id: "desc",
        label: "your biography here",
        type: "text",
        value: "",
        id_upper: "Biography"
      },
      skills: {
        id: "skills",
        label: "your skills here",
        type: "text",
        value: "",
        id_upper: "Skills"
      },
      education: {
        id: "education",
        label: "your education here",
        type: "text",
        value: "",
        id_upper: "Education"
      }
    };
  }
};
</script>

<style scoped>
#hands_icon {
  vertical-align: middle;
}
#job_poster {
}
.group_input_title {
  margin-bottom: 6%;
}
.group_input_title_first {
  margin-top: 3%;
}
textarea {
  box-shadow: 0px 0px 2px #949494;
  text-align: center;
  outline: none !important;
  border-bottom: 1px solid rgba(0, 8, 53, 0.603);
  background-color: transparent;
  border: 0px;
  width: 100%;
  min-height: 80px;
}

.has-error {
  border: 1px solid rgba(255, 0, 0, 1);
}
</style>
