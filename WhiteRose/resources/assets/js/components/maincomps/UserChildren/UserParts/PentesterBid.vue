<template>
  <div id="pentester_bid" class="comp_container">
    
    <b-button  class="btn btn-danger btn-secondary" id="close_btn" @click="disableBid()">
      <icon
      name ="window-close">
      </icon>  
    </b-button>
    
    <h2 class="h2s">Job:</h2>
    <p>{{title}}</p> 
    
    <h2 class="h2s">Price:</h2>
    <p>{{det.amount}}</p>

    <h2 class="h2s">Pentester:</h2>
    <p>{{det.pentester_username}} ( {{det.pentester}} )</p>
    
    <h2 class="h2s">Message:</h2>
    <p>{{det.description}}</p>

    <b-button 
    v-if="det.accepted != 1 && !det.declined_flag"  
    class="btn btn-success btn-secondary" 
      @click="notifyPentester()">
        Accept

        <icon
        id="ico"
        name ="check">
        </icon>  
    
    </b-button>

    
    <b-button v-if="det.accepted == 1 && !det.declined_flag"  class="btn btn-success btn-secondary disabled">
        Accepted
        <icon
        id="ico"
        name ="check">
        </icon>  
    </b-button>

    <b-button 
    v-if="det.declined_flag && det.accepted == 0"
    class="btn btn-danger btn-secondary disabled">
        Declined
        <icon
        id="ico"
        name ="times">
        </icon>  
    </b-button>


  </div>

</template>

<script>
import eventBus from "../../../../utils/eventBus";

import Icon from "vue-awesome/components/Icon";
import "vue-awesome/icons/window-close";
import "vue-awesome/icons/check";

export default {
  components: {
    Icon
  },
  mixins: [],
  props: {
    title: {
      type: String
    },
    det: {
      type: Object,
      twoWay: true
    }
  },
  computed: {},
  mounted() {
    console.log(this.det);
  },
  methods: {
    notifyPentester() {
      axios
        .post("accept", {
          bidID: this.det.id
        })
        .then(response => {
          console.log(response.data);
        })
        .catch(err => {
          //error snotify here.
        });

      this.det.accepted = true;
      eventBus.$emit("isVisiblePentesterBid", false);
    },
    disableBid() {
      eventBus.$emit("isVisiblePentesterBid", false);
    }
  },
  data() {
    return {};
  }
};
</script>

<style scoped>
#ico {
  vertical-align: middle;
}
#close_btn >>> svg {
  vertical-align: middle;
}

#close_btn {
  float: right;
}
#pentester_bid {
}
</style>
