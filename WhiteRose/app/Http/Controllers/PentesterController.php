<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Auth\RequestGuard;
use App\Pentester;

class PentesterController extends Controller
{
    //

    public function bidOnJob(Request $request)
    {
        $price=$request->price;
        $jobID=$request->jobID;
        $pentesterID=$request->penteserID;
        $clientID=$request->clientID;

        if(Job::where('id',$jobID)->first()->maximum_price>$price)
            {
                $message=new Message;
                $message->client_id=$clientID;
                $message->from=Pentester::where('id',$pentesterID)->username;
                $message->text=Pentester::where('id',$pentesterID)->username.'just bidded on your
                job.'.$price.Pentester::where('id',$pentesterID)->email;
                $message->pentester_id=$pentesterID;

                $bid=new Bid;
                $bid->amount=$price;
                $bid->job_id=$jobID;

                $bid->save();
                $message->save();


            }
    }
}
